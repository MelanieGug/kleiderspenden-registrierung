<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kleiderspenden-Registrierung</title>

  <!-- Bootstrap (Framework für Responsive Design) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
  .nav-align-end { margin-inline-start: auto; }
</style>
</head>

<body class="bg-light">
  <!-- HEADER + NAV -->
<header class="border-bottom site-header">
    <nav class="navbar navbar-expand-lg navbar-light container py-2">
      <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
        <!-- Mini-Logo (kein Extra-Datei-Download nötig) -->
<img src="mg-logo.png" alt="MG Kleiderspendenportal Logo" height="32" class="d-inline-block align-text-top">
<span class="fw-semibold d-none d-sm-inline">Kleiderspenden-Portal</span>
<link rel="icon" type="image/png" href="assets/mg-logo.png">
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="nav">
<ul class="navbar-nav nav-align-end">
<a class="nav-link" href="index.html#registrierung">Registrierung</a>
<a class="nav-link" href="info.html">Info</a>
        </ul>
      </div>
    </nav>
  </header>

  <!-- CONTENT -->
  <main class="container my-4" id="registrierung">
    <section class="hero p-4 p-md-5 mb-4">
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3">
    <div>
      <h1 class="h3 mb-2">Kleiderspende schnell registrieren</h1>
      <p class="text-muted mb-0">
        Wähle Übergabe oder Abholung – danach erhältst du eine Bestätigung mit Datum/Uhrzeit und Ort.
      </p>
    </div>
    <a class="btn btn-primary" href="#registrierung">Zur Registrierung</a>
  </div>
</section>
    <div class="row justify-content-center">
      <div class="col-12 col-lg-8">
        <div class="card shadow-sm">
          <div class="card-body p-4">
            <h1 class="h4 mb-3">Kleiderspende registrieren</h1>
            <p class="text-muted mb-4">
              Wähle, ob du die Kleidung an der Geschäftsstelle abgibst oder abholen lässt.
            </p>

            <form id="donationForm" novalidate>
              <!-- Übergabe / Abholung -->
              <div class="mb-3">
                <label class="form-label fw-semibold">Übergabeart</label>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="deliveryType" id="typeOffice" value="office" checked>
                  <label class="form-check-label" for="typeOffice">Übergabe an der Geschäftsstelle</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="deliveryType" id="typePickup" value="pickup">
                  <label class="form-check-label" for="typePickup">Abholung (Sammelfahrzeug)</label>
                </div>
              </div>

              <!-- Kleidung -->
              <div class="mb-3">
                <label for="clothingType" class="form-label fw-semibold">Art der Kleidung</label>
                <select id="clothingType" class="form-select" required>
                  <option value="" selected disabled>Bitte wählen …</option>
                  <option>Jacken/Mäntel</option>
                  <option>Hosen</option>
                  <option>Schuhe</option>
                  <option>Kinderkleidung</option>
                  <option>Bettwäsche/Decken</option>
                </select>
                <div class="invalid-feedback">Bitte wähle eine Kleidungsart aus.</div>
              </div>

              <!-- Krisengebiet -->
              <div class="mb-3">
                <label for="crisisRegion" class="form-label fw-semibold">Krisengebiet (Beispiele)</label>
                <select id="crisisRegion" class="form-select" required>
                  <option value="" selected disabled>Bitte wählen …</option>
                  <option>Hochwasser-Region</option>
                  <option>Erdbeben-Region</option>
                  <option>Dürre-Region</option>
                  <option>Konfliktregion (allgemein)</option>
                </select>
                <div class="invalid-feedback">Bitte wähle ein Krisengebiet aus.</div>
              </div>

              <!-- Abholadresse (nur bei Abholung sichtbar) -->
              <div id="pickupFields" class="border rounded p-3 mb-3 d-none">
                <p class="mb-2 fw-semibold">Abholadresse</p>

                <div class="mb-3">
                  <label for="street" class="form-label">Straße & Hausnummer</label>
                  <input id="street" class="form-control" type="text" placeholder="z. B. Musterstraße 12">
                  <div class="invalid-feedback">Bitte gib Straße und Hausnummer an.</div>
                </div>

                <div class="row g-2">
                  <div class="col-12 col-md-4">
                    <label for="zip" class="form-label">PLZ</label>
                    <input id="zip" class="form-control" type="text" inputmode="numeric" placeholder="z. B. 10115">
                    <div class="invalid-feedback" id="zipError">Bitte gib eine gültige PLZ ein.</div>
                  </div>
                  <div class="col-12 col-md-8">
                    <label for="city" class="form-label">Ort</label>
                    <input id="city" class="form-control" type="text" placeholder="z. B. Berlin">
                    <div class="invalid-feedback">Bitte gib einen Ort an.</div>
                  </div>
                </div>

                <p class="text-muted mt-3 mb-0 small">
                  Hinweis: Für die Abholung muss die PLZ in der Nähe der Geschäftsstelle liegen (erste 2 Ziffern identisch).
                </p>
              </div>

              <button class="btn btn-primary w-100" type="submit">Registrierung abschließen</button>
            </form>
          </div>
        </div>

        <section id="info" class="mt-4 text-muted small">
          <p class="mb-1"><strong>Geschäftsstelle (Beispiel):</strong> Musterstraße 1, 10115 Berlin</p>
          <p class="mb-0">Diese Seite ist eine Studien-Fallstudie und nutzt fiktive Beispiele.</p>
        </section>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="border-top bg-white">
    <div class="container py-3 d-flex flex-column flex-md-row justify-content-between gap-2">
<span class="text-muted small footer-links">
  <a class="text-muted small" href="impressum.html">Impressum</a>
  <span class="text-muted small"> · </span>
  <a class="text-muted small" href="datenschutz.html">Datenschutz</a>
  <span class="text-muted small"> · </span>
  <a class="text-muted small" href="hinweise.html">Rechtliche Hinweise</a>
</span>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // >>> Hier kannst du die PLZ der Geschäftsstelle anpassen (nur diese eine Stelle ändern)
    const OFFICE_ZIP = "10115"; // Geschäftsstelle-PLZ (Beispiel)
    const OFFICE_LOCATION_TEXT = "Geschäftsstelle: Musterstraße 1, 10115 Berlin";

    const form = document.getElementById("donationForm");
    const pickupFields = document.getElementById("pickupFields");

    const clothingType = document.getElementById("clothingType");
    const crisisRegion = document.getElementById("crisisRegion");

    const street = document.getElementById("street");
    const zip = document.getElementById("zip");
    const city = document.getElementById("city");
    const zipError = document.getElementById("zipError");

    function getDeliveryType() {
      return document.querySelector('input[name="deliveryType"]:checked').value;
    }

    function setPickupVisibility() {
      const isPickup = getDeliveryType() === "pickup";
      pickupFields.classList.toggle("d-none", !isPickup);
    }

    // Beim Umschalten ein-/ausblenden
    document.getElementById("typeOffice").addEventListener("change", setPickupVisibility);
    document.getElementById("typePickup").addEventListener("change", setPickupVisibility);
    setPickupVisibility();

    function markValid(el) {
      el.classList.remove("is-invalid");
      el.classList.add("is-valid");
    }
    function markInvalid(el) {
      el.classList.remove("is-valid");
      el.classList.add("is-invalid");
    }

    function isFiveDigits(value) {
      return /^[0-9]{5}$/.test(value);
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      // Reset Validierungs-Styles
      [clothingType, crisisRegion, street, zip, city].forEach(el => {
        el.classList.remove("is-valid", "is-invalid");
      });

      let ok = true;

      // Pflichtfelder: Kleidung + Krisengebiet
      if (!clothingType.value) { markInvalid(clothingType); ok = false; } else { markValid(clothingType); }
      if (!crisisRegion.value) { markInvalid(crisisRegion); ok = false; } else { markValid(crisisRegion); }

      const deliveryType = getDeliveryType();

      // Zusätzliche Pflichtfelder bei Abholung
      if (deliveryType === "pickup") {
        if (!street.value.trim()) { markInvalid(street); ok = false; } else { markValid(street); }
        if (!city.value.trim())   { markInvalid(city); ok = false; } else { markValid(city); }

        const z = zip.value.trim();
        if (!isFiveDigits(z)) {
          zipError.textContent = "Bitte gib eine PLZ mit genau 5 Ziffern ein.";
          markInvalid(zip); ok = false;
        } else if (z.slice(0,2) !== OFFICE_ZIP.slice(0,2)) {
          // Anforderung: erste zwei Postleitzahlen identisch (Nähe zur Geschäftsstelle)
          zipError.textContent = "Diese PLZ ist nicht in der Nähe der Geschäftsstelle (erste 2 Ziffern müssen übereinstimmen).";
          markInvalid(zip); ok = false;
        } else {
          markValid(zip);
        }
      }

      if (!ok) return;

      // Daten für Bestätigungsseite speichern
      const now = new Date();
      const data = {
        deliveryType,
        clothingType: clothingType.value,
        crisisRegion: crisisRegion.value,
        // Ort je nach Übergabeart
        location:
          deliveryType === "office"
            ? OFFICE_LOCATION_TEXT
            : `Abholadresse: ${street.value.trim()}, ${zip.value.trim()} ${city.value.trim()}`,
        timestamp: now.toISOString()
      };

      sessionStorage.setItem("donationData", JSON.stringify(data));
      window.location.href = "confirm.html";
    });
  </script>
  <script>
  (function () {
    const rtlLangs = ["ar", "he", "fa", "ur"];
    const langs = (navigator.languages && navigator.languages.length)
      ? navigator.languages
      : [navigator.language || ""];
    const isRtl = langs.some(l => rtlLangs.includes(l.split("-")[0].toLowerCase()));
    document.documentElement.setAttribute("dir", isRtl ? "rtl" : "ltr");
  })();
</script>
</body>
</html>
